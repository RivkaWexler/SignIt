import{a as O}from"./chunk-QABIK4F6.js";import{a as ie,b as oe,c as re,d as ae,e as se,f as le,g as ce,h as de,i as pe,j as ge,k as me}from"./chunk-PWVN3RVT.js";import{a as P,b as B,c as te,d as ne}from"./chunk-XY6EKUD7.js";import{$ as C,C as f,D as L,F as D,I as d,J as r,K as a,L as p,M as h,N as g,O as c,P as Q,Q as b,R as v,S as Y,T as M,U as Z,V as z,W as j,X as R,Y as G,_ as x,ga as A,ha as w,ia as N,j as q,ja as y,k as m,l as u,m as V,ma as ee,n as K,u as U,v as l,x as k,y as S}from"./chunk-TZAG237N.js";import{e as I}from"./chunk-FDERIQAA.js";function Ce(i,t){if(i&1&&(r(0,"li"),v(1),p(2,"span",18),v(3,") "),a()),i&2){let e=t.$implicit;l(),Z(" ",e.name," (",(e.size/1024).toFixed(1)," ")}}function be(i,t){if(i&1&&(r(0,"div",13)(1,"div",14)(2,"strong"),p(3,"span",15),v(4,":"),a(),v(5),a(),r(6,"ul",16),f(7,Ce,4,2,"li",17),a()()),i&2){let e=c();l(5),M(" (",e.selectedFiles.length,") "),l(2),d("ngForOf",e.selectedFiles)}}function Me(i,t){if(i&1){let e=h();r(0,"div",19)(1,"button",20),g("click",function(){m(e);let o=c();return u(o.triggerFileInput(!1))}),a(),r(2,"button",21),g("click",function(){m(e);let o=c();return u(o.triggerFileInput(!0))}),a()()}}var T=class i{translations=P;acceptedTypes="";multiple=!1;label="Upload Files";dropzoneText="Drag & Drop files here or click to browse";allowFolders=!1;filesSelected=new L;isHovering=!1;selectedFiles=[];constructor(){}onDragOver(t){t.preventDefault(),t.stopPropagation(),this.isHovering=!0}onDragLeave(t){t.preventDefault(),t.stopPropagation(),this.isHovering=!1}onDrop(t){t.preventDefault(),t.stopPropagation(),this.isHovering=!1;let e=t.dataTransfer?.files;e&&e.length>0&&this.handleFiles(e)}onFileInputChange(t){let e=t.target;e.files&&e.files.length>0&&this.handleFiles(e.files)}handleFiles(t){if(!this.multiple&&t.length>1){let e=new DataTransfer;e.items.add(t[0]),this.filesSelected.emit(e.files),this.selectedFiles=[t[0]]}else this.filesSelected.emit(t),this.selectedFiles=Array.from(t)}triggerFileInput(t=!1){let e=document.getElementById("file-input");e&&e.remove();let n=document.createElement("input");n.type="file",n.id="file-input",n.classList.add("hidden-input"),n.multiple=this.multiple,n.accept=this.acceptedTypes,t&&(n.setAttribute("webkitdirectory",""),n.setAttribute("directory","")),n.addEventListener("change",o=>{this.onFileInputChange(o)}),document.body.appendChild(n),n.click()}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=S({type:i,selectors:[["app-file-upload"]],inputs:{acceptedTypes:"acceptedTypes",multiple:"multiple",label:"label",dropzoneText:"dropzoneText",allowFolders:"allowFolders"},outputs:{filesSelected:"filesSelected"},decls:15,vars:10,consts:[[1,"file-upload-container"],["for","file-input",1,"file-upload-label"],[1,"dropzone",3,"dragover","dragleave","drop","click"],[1,"dropzone-content"],[1,"upload-icon"],["xmlns","http://www.w3.org/2000/svg","width","40","height","40","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["d","M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"],["points","17 8 12 3 7 8"],["x1","12","y1","3","x2","12","y2","15"],[1,"dropzone-text"],["class","selected-files",4,"ngIf"],["type","file","id","file-input",1,"hidden-input",3,"change","accept","multiple"],["class","upload-options",4,"ngIf"],[1,"selected-files"],[1,"selected-files-heading"],["appTranslate","selected_files"],[1,"file-list"],[4,"ngFor","ngForOf"],["appTranslate","kilobytes"],[1,"upload-options"],["appTranslate","select_files",1,"btn","btn-sm","btn-outline-primary",3,"click"],["appTranslate","select_folder",1,"btn","btn-sm","btn-outline-primary",3,"click"]],template:function(e,n){e&1&&(r(0,"div",0)(1,"label",1),v(2),a(),r(3,"div",2),g("dragover",function(s){return n.onDragOver(s)})("dragleave",function(s){return n.onDragLeave(s)})("drop",function(s){return n.onDrop(s)})("click",function(){return n.triggerFileInput()}),r(4,"div",3)(5,"div",4),V(),r(6,"svg",5),p(7,"path",6)(8,"polyline",7)(9,"line",8),a()(),K(),r(10,"p",9),v(11),a(),f(12,be,8,2,"div",10),a()(),r(13,"input",11),g("change",function(s){return n.onFileInputChange(s)}),a(),f(14,Me,3,0,"div",12),a()),e&2&&(l(2),Y(n.label),l(),b("active",n.isHovering),l(8),Y(n.dropzoneText),l(),d("ngIf",n.selectedFiles.length>0),l(),d("accept",n.acceptedTypes)("multiple",n.multiple),D("webkitdirectory",n.allowFolders?"":null)("directory",n.allowFolders?"":null),l(),d("ngIf",n.allowFolders))},dependencies:[y,A,w,O],styles:[".file-upload-container[_ngcontent-%COMP%]{margin-bottom:1.5rem}.file-upload-label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem;font-weight:500;color:#333}.dropzone[_ngcontent-%COMP%]{border:2px dashed #ced4da;border-radius:.5rem;padding:2rem;text-align:center;cursor:pointer;transition:all .3s ease;background-color:#f8f9fa}.dropzone.active[_ngcontent-%COMP%]{border-color:#3498db;background-color:#3498db1a}.dropzone[_ngcontent-%COMP%]:hover{border-color:#adb5bd}.dropzone-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center}.upload-icon[_ngcontent-%COMP%]{margin-bottom:1rem;color:#6c757d}.dropzone.active[_ngcontent-%COMP%]   .upload-icon[_ngcontent-%COMP%]{color:#3498db}.dropzone-text[_ngcontent-%COMP%]{margin-bottom:1rem;color:#6c757d}.hidden-input[_ngcontent-%COMP%]{display:none}.selected-files[_ngcontent-%COMP%]{margin-top:1.5rem;width:100%;text-align:left;background-color:#fff;border-radius:.25rem;padding:1rem;box-shadow:0 1px 3px #0000001a}.selected-files-heading[_ngcontent-%COMP%]{margin-bottom:10px}.file-list[_ngcontent-%COMP%]{max-height:150px;overflow-y:auto;padding-left:20px;margin:0}.file-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:5px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.upload-options[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:10px;margin-top:15px}.upload-options[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:8px 16px;border-radius:4px;text-align:center;width:140px;font-weight:500;transition:all .2s ease}.selected-files-heading[_ngcontent-%COMP%]{margin-bottom:.5rem;color:#333}.file-list[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0;max-height:150px;overflow-y:auto}.file-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding:.5rem 0;border-bottom:1px solid #f0f0f0;font-size:.9rem;color:#666;display:flex;justify-content:space-between}.file-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:last-child{border-bottom:none}"]})};var H,Se=new Uint8Array(16);function J(){if(!H&&(H=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!H))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return H(Se)}var _=[];for(let i=0;i<256;++i)_.push((i+256).toString(16).slice(1));function ve(i,t=0){return _[i[t+0]]+_[i[t+1]]+_[i[t+2]]+_[i[t+3]]+"-"+_[i[t+4]]+_[i[t+5]]+"-"+_[i[t+6]]+_[i[t+7]]+"-"+_[i[t+8]]+_[i[t+9]]+"-"+_[i[t+10]]+_[i[t+11]]+_[i[t+12]]+_[i[t+13]]+_[i[t+14]]+_[i[t+15]]}var we=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),$={randomUUID:we};function ye(i,t,e){if($.randomUUID&&!t&&!i)return $.randomUUID();i=i||{};let n=i.random||(i.rng||J)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,t){e=e||0;for(let o=0;o<16;++o)t[e+o]=n[o];return t}return ve(n)}var E=ye;function Pe(i,t){if(i&1){let e=h();r(0,"div",12)(1,"app-file-upload",13),x(2,"async"),x(3,"async"),g("filesSelected",function(o){m(e);let s=c(2);return u(s.onFileSelected(o))}),a()()}if(i&2){let e=c(2);l(),d("acceptedTypes","image/*")("multiple",!1)("label",e.translations[C(2,4,e.languageService.selectedLanguage)||"en"].upload_signature_image)("dropzoneText",e.translations[C(3,6,e.languageService.selectedLanguage)||"en"].drag_drop_signature)}}function Oe(i,t){if(i&1){let e=h();r(0,"div",14)(1,"div",15),p(2,"canvas",16),a(),r(3,"div",17)(4,"button",18),g("click",function(){m(e);let o=c(2);return u(o.clearCanvas())}),p(5,"span",19),a(),r(6,"button",20),g("click",function(){m(e);let o=c(2);return u(o.saveSignature())}),p(7,"span",21),a()()()}}function Te(i,t){if(i&1){let e=h();r(0,"div",4)(1,"div",5)(2,"button",6),g("click",function(){m(e);let o=c();return u(o.drawingMode=!1)}),p(3,"span",7),a(),r(4,"button",6),g("click",function(){m(e);let o=c();return u(o.toggleDrawingMode())}),p(5,"span",8),a()(),r(6,"div",9),f(7,Pe,4,8,"div",10)(8,Oe,8,0,"div",11),a()()}if(i&2){let e=c();l(2),b("active",!e.drawingMode),l(2),b("active",e.drawingMode),l(3),d("ngIf",!e.drawingMode),l(),d("ngIf",e.drawingMode)}}function Ee(i,t){if(i&1){let e=h();r(0,"div",22)(1,"div",23),p(2,"h4",24),r(3,"button",25),g("click",function(){m(e);let o=c();return u(o.removeSignature())}),p(4,"span",26),a()(),r(5,"div",27),p(6,"img",28),a()()}if(i&2){let e=c();l(6),d("src",e.signature.preview,U)}}var W=class i{signatureSelected=new L;signature=null;drawingMode=!1;canvas=null;ctx=null;isDrawing=!1;lastX=0;lastY=0;languageService=q(B);constructor(){}ngAfterViewInit(){this.initializeCanvas()}initializeCanvas(){this.canvas=document.getElementById("signature-canvas"),this.canvas&&(this.ctx=this.canvas.getContext("2d"),this.ctx&&(this.ctx.lineJoin="round",this.ctx.lineCap="round",this.ctx.lineWidth=2,this.ctx.strokeStyle="#000"),this.setupCanvasListeners())}setupCanvasListeners(){this.canvas&&(this.canvas.addEventListener("mousedown",t=>this.startDrawing(t)),this.canvas.addEventListener("mousemove",t=>this.draw(t)),this.canvas.addEventListener("mouseup",()=>this.stopDrawing()),this.canvas.addEventListener("mouseout",()=>this.stopDrawing()),this.canvas.addEventListener("touchstart",t=>{t.preventDefault();let e=t.touches[0],n=new MouseEvent("mousedown",{clientX:e.clientX,clientY:e.clientY});this.startDrawing(n)}),this.canvas.addEventListener("touchmove",t=>{t.preventDefault();let e=t.touches[0],n=new MouseEvent("mousemove",{clientX:e.clientX,clientY:e.clientY});this.draw(n)}),this.canvas.addEventListener("touchend",()=>this.stopDrawing()))}toggleDrawingMode(){this.drawingMode=!this.drawingMode,this.drawingMode&&setTimeout(()=>this.initializeCanvas(),0)}startDrawing(t){if(!this.ctx||!this.canvas)return;this.isDrawing=!0;let e=this.canvas.getBoundingClientRect();this.lastX=t.clientX-e.left,this.lastY=t.clientY-e.top}draw(t){if(!this.isDrawing||!this.ctx||!this.canvas)return;let e=this.canvas.getBoundingClientRect(),n=t.clientX-e.left,o=t.clientY-e.top;this.ctx.beginPath(),this.ctx.moveTo(this.lastX,this.lastY),this.ctx.lineTo(n,o),this.ctx.stroke(),this.lastX=n,this.lastY=o}stopDrawing(){this.isDrawing=!1}clearCanvas(){this.ctx&&this.canvas&&this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)}saveSignature(){if(!this.canvas)return;let t=this.canvas.toDataURL("image/png"),e={id:E(),type:"svg",content:t,preview:t};this.signature=e,this.signatureSelected.emit(e),this.drawingMode=!1}onFileSelected(t){if(t&&t.length>0){let e=t[0],n=new FileReader;n.onload=o=>{if(o.target?.result){let s={id:E(),type:"image",content:e,preview:o.target.result};this.signature=s,this.signatureSelected.emit(s)}},n.readAsDataURL(e)}}removeSignature(){this.signature=null,this.signatureSelected.emit(null)}translations=P;static \u0275fac=function(e){return new(e||i)};static \u0275cmp=S({type:i,selectors:[["app-signature-upload"]],outputs:{signatureSelected:"signatureSelected"},decls:4,vars:2,consts:[[1,"signature-upload-container"],["appTranslate","add_your_signature"],["class","signature-methods",4,"ngIf"],["class","signature-preview",4,"ngIf"],[1,"signature-methods"],[1,"method-tabs"],[1,"method-tab",3,"click"],["appTranslate","upload_image"],["appTranslate","draw_signature"],[1,"method-content"],["class","upload-method",4,"ngIf"],["class","draw-method",4,"ngIf"],[1,"upload-method"],[3,"filesSelected","acceptedTypes","multiple","label","dropzoneText"],[1,"draw-method"],[1,"canvas-container"],["id","signature-canvas","width","400","height","200"],[1,"canvas-controls"],[1,"btn","btn-secondary",3,"click"],["appTranslate","clear"],[1,"btn","btn-primary",3,"click"],["appTranslate","save_signature"],[1,"signature-preview"],[1,"preview-header"],["appTranslate","your_signature"],[1,"btn","btn-sm","btn-secondary",3,"click"],["appTranslate","change"],[1,"preview-image-container"],["alt","Signature preview",1,"preview-image",3,"src"]],template:function(e,n){e&1&&(r(0,"div",0),p(1,"h3",1),f(2,Te,9,6,"div",2)(3,Ee,7,1,"div",3),a()),e&2&&(l(2),d("ngIf",!n.signature),l(),d("ngIf",n.signature))},dependencies:[y,w,N,T,O],styles:[".signature-upload-container[_ngcontent-%COMP%]{margin-bottom:2rem}.signature-methods[_ngcontent-%COMP%]{margin-top:1rem}.method-tabs[_ngcontent-%COMP%]{display:flex;margin-bottom:1rem;border-bottom:1px solid #dee2e6}.method-tab[_ngcontent-%COMP%]{padding:.75rem 1.5rem;background:none;border:none;border-bottom:2px solid transparent;cursor:pointer;color:#6c757d;font-weight:500;transition:all .2s ease}.method-tab[_ngcontent-%COMP%]:hover{color:#3498db}.method-tab.active[_ngcontent-%COMP%]{color:#3498db;border-bottom:2px solid #3498db}.method-content[_ngcontent-%COMP%]{padding:1rem 0}.canvas-container[_ngcontent-%COMP%]{border:1px solid #ced4da;border-radius:.25rem;background-color:#fff;margin-bottom:1rem;display:flex;justify-content:center}canvas[_ngcontent-%COMP%]{touch-action:none}.canvas-controls[_ngcontent-%COMP%]{display:flex;justify-content:space-between;gap:1rem}.signature-preview[_ngcontent-%COMP%]{margin-top:1rem;padding:1rem;border:1px solid #e9ecef;border-radius:.25rem;background-color:#f8f9fa}.preview-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.preview-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0;font-size:1.1rem;color:#495057}.btn-sm[_ngcontent-%COMP%]{padding:.25rem .5rem;font-size:.875rem}.preview-image-container[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:1rem;background-color:#fff;border:1px solid #dee2e6;border-radius:.25rem}.preview-image[_ngcontent-%COMP%]{max-width:100%;max-height:150px;object-fit:contain}.btn-secondary[_ngcontent-%COMP%]{background-color:#6c757d;color:#fff}.btn-secondary[_ngcontent-%COMP%]:hover{background-color:#5a6268}"]})};function Fe(i,t){if(i&1&&(r(0,"div",25),v(1),a()),i&2){let e=c();l(),M(" ",e.translate(e.error)," ")}}function ke(i,t){if(i&1){let e=h();r(0,"div")(1,"app-file-upload",26),x(2,"async"),x(3,"async"),g("filesSelected",function(o){m(e);let s=c();return u(s.onDocumentsSelected(o))}),a()()}if(i&2){let e=c();l(),d("acceptedTypes","application/pdf,image/*")("multiple",!0)("allowFolders",!0)("label",e.translations[C(2,5,e.languageService.selectedLanguage)||"en"].select_documents_folder)("dropzoneText",e.translations[C(3,7,e.languageService.selectedLanguage)||"en"].drag_drop_files)}}function De(i,t){if(i&1&&(r(0,"div",46),p(1,"img",47),a()),i&2){let e=c().$implicit;l(),d("src",e.preview,U)("alt",e.name)}}function Ie(i,t){i&1&&(r(0,"div",48),V(),r(1,"svg",49),p(2,"path",50),a()())}function Ve(i,t){if(i&1){let e=h();r(0,"div",38)(1,"div",39)(2,"span",40),v(3),x(4,"async"),x(5,"async"),a(),r(6,"button",41),x(7,"async"),g("click",function(){let o=m(e).index,s=c(2);return u(s.removeDocument(o))}),v(8,"\xD7"),a()(),r(9,"div",42),f(10,De,2,2,"div",43)(11,Ie,3,0,"div",44),a(),r(12,"div",45),v(13),a()()}if(i&2){let e=t.$implicit,n=c(2);l(2),b("pdf",e.type==="pdf")("image",e.type==="image"),l(),M(" ",e.type==="pdf"?n.translations[C(4,10,n.languageService.selectedLanguage)||"en"].pdf:n.translations[C(5,12,n.languageService.selectedLanguage)||"en"].image," "),l(3),D("aria-label",n.translations[C(7,14,n.languageService.selectedLanguage)||"en"].remove),l(4),d("ngIf",e.type==="image"),l(),d("ngIf",e.type==="pdf"),l(),d("title",e.name),l(),M(" ",e.name," ")}}function Ue(i,t){if(i&1){let e=h();r(0,"div",27)(1,"div",28)(2,"h4"),p(3,"span",29),v(4),a(),r(5,"button",30),g("click",function(){m(e);let o=c();return u(o.clearAllDocuments())}),a()(),r(6,"div",31),f(7,Ve,14,16,"div",32),r(8,"div",33)(9,"div",34),g("click",function(){m(e);let o=c();return u(o.triggerFileUpload(!1))}),r(10,"div",35),v(11,"+"),a(),p(12,"div",36),a(),r(13,"div",34),g("click",function(){m(e);let o=c();return u(o.triggerFileUpload(!0))}),r(14,"div",35),v(15,"\u{1F4C1}"),a(),p(16,"div",37),a()()()()}if(i&2){let e=c();l(4),M(" (",e.documents.length,")"),l(3),d("ngForOf",e.documents)}}function Le(i,t){if(i&1){let e=h();r(0,"button",51),g("click",function(){let o=m(e).$implicit,s=c();return u(s.signaturePosition=o)}),a()}if(i&2){let e=t.$implicit,n=c();b("active",n.signaturePosition===e),d("appTranslate",G(e)),D("data-position",e)}}function ze(i,t){if(i&1){let e=h();r(0,"div",57)(1,"input",58),R("ngModelChange",function(o){m(e);let s=c(2);return j(s.pageSelectionMode,o)||(s.pageSelectionMode=o),u(o)}),g("change",function(){let o=m(e).$implicit,s=c(2);return u(s.onPageSelectionModeChange(o))}),a(),p(2,"label",59),a()}if(i&2){let e=t.$implicit,n=c(2);l(),d("id","mode-"+e)("value",e),z("ngModel",n.pageSelectionMode),l(),d("appTranslate",G(e))("for","mode-"+e)}}function je(i,t){if(i&1){let e=h();r(0,"div",60)(1,"div",61)(2,"div",62),p(3,"label",63),r(4,"input",64),R("ngModelChange",function(o){m(e);let s=c(2);return j(s.pageStart,o)||(s.pageStart=o),u(o)}),g("change",function(){m(e);let o=c(2);return u(o.updatePageRange())}),a()(),r(5,"div",62),p(6,"label",65),r(7,"input",66),R("ngModelChange",function(o){m(e);let s=c(2);return j(s.pageEnd,o)||(s.pageEnd=o),u(o)}),g("change",function(){m(e);let o=c(2);return u(o.updatePageRange())}),a()()()()}if(i&2){let e=c(2);l(4),z("ngModel",e.pageStart),d("max",e.getMaxPageCount()),l(3),z("ngModel",e.pageEnd),d("min",e.pageStart)("max",e.getMaxPageCount())}}function Re(i,t){if(i&1&&(r(0,"div",52),p(1,"h4",53),r(2,"div",54),f(3,ze,3,6,"div",55),a(),f(4,je,8,5,"div",56),a()),i&2){let e=c();l(3),d("ngForOf",e.pageSelectionModeOptions),l(),d("ngIf",e.showCustomRange)}}function Ae(i,t){if(i&1&&(r(0,"div",67)(1,"div",68)(2,"div",69),v(3),a()(),p(4,"p",70),a()),i&2){let e=c();l(2),Q("width",e.processingProgress,"%"),l(),M(" ",e.processingProgress,"% ")}}function Ne(i,t){i&1&&p(0,"span",71)}function Be(i,t){i&1&&p(0,"span",72)}var he=class i{constructor(t,e,n,o){this.documentService=t;this.router=e;this.translationService=n;this.languageService=o}translations=P;documents=[];signature=null;isProcessing=!1;error=null;processingProgress=0;signaturePosition="bottom-center";signaturePositionOptions=Object.values(ge);pageSelectionMode="all-pages";pageSelectionModeOptions=Object.values(pe);pageStart=1;pageEnd=1;showCustomRange=!1;translate(t){return this.translationService.translate(t)}onDocumentsSelected(t){return I(this,null,function*(){if(!t||t.length===0)return;let e=[],n=[];for(let o=0;o<t.length;o++){let s=t[o];this.getDocumentType(s)?e.push(s):n.push(s.name)}if(e.length>0){let o=[];for(let s of e){let F=this.getDocumentType(s),xe=yield this.documentService.generatePreview(s),X=1;F==="pdf"&&(X=yield this.documentService.getPdfPageCount(s)),o.push({id:E(),name:s.name,type:F,content:s,preview:xe,signed:!1,pageCount:X,pageSelectionMode:"all-pages",pageStart:1,pageEnd:X})}this.documents=[...this.documents,...o]}})}onSignatureSelected(t){this.signature=t}getDocumentType(t){let e=t.type.toLowerCase();return e==="application/pdf"?"pdf":e.startsWith("image/")?"image":null}signDocuments(){return I(this,null,function*(){let t=this.languageService.getCurrentLanguage();if(this.documents.length===0||!this.signature){this.error=this.translations[t].select_docs_signature;return}try{this.isProcessing=!0,this.processingProgress=0;let e=[],n=this.documents.length;for(let o=0;o<n;o++){let s=this.documents[o];s.signaturePosition=this.signaturePosition,s.pageSelectionMode||(s.pageSelectionMode=this.pageSelectionMode,this.pageSelectionMode==="custom-range"&&(s.pageStart=this.pageStart,s.pageEnd=Math.min(this.pageEnd,s.pageCount||1)));let F=yield this.documentService.signDocument(s,this.signature);e.push(F),this.processingProgress=Math.round((o+1)/n*100)}this.documentService.setProcessedDocuments(e),this.documentService.setSignature(this.signature),this.router.navigate(["/result"])}catch(e){let n=this.languageService.getCurrentLanguage();this.error=this.translations[n].error_signing,console.error("Error signing documents:",e)}finally{this.isProcessing=!1}})}removeDocument(t){this.documents.splice(t,1)}clearAllDocuments(){this.documents=[]}reset(){this.documents=[],this.signature=null,this.error=null,this.processingProgress=0}onPageSelectionModeChange(t){this.pageSelectionMode=t,this.showCustomRange=t==="custom-range",this.documents.forEach(e=>{e.pageSelectionMode=t,t==="custom-range"&&(this.pageStart||(this.pageStart=1),this.pageEnd||(this.pageEnd=e.pageCount||1),e.pageStart=this.pageStart,e.pageEnd=this.pageEnd)})}updatePageRange(){let t=Math.max(1,this.pageStart),e=Math.min(this.pageEnd,this.getMaxPageCount());this.pageStart=t,this.pageEnd=e,this.documents.forEach(n=>{n.pageSelectionMode==="custom-range"&&(n.pageStart=t,n.pageEnd=Math.min(e,n.pageCount||1))})}getMaxPageCount(){let t=1;return this.documents.forEach(e=>{e.pageCount&&e.pageCount>t&&(t=e.pageCount)}),t}hasMultiPageDocuments(){if(this.documents.length===0)return!1;for(let t of this.documents)if((t.pageCount||1)>1)return!0;return!1}triggerFileUpload(t=!1){let e=document.createElement("input");e.type="file",e.multiple=!0,e.accept="application/pdf,image/*",t&&(e.setAttribute("webkitdirectory",""),e.setAttribute("directory","")),e.addEventListener("change",n=>I(this,null,function*(){let o=n.target;o.files&&o.files.length>0&&(yield this.onDocumentsSelected(o.files))})),e.click()}static \u0275fac=function(e){return new(e||i)(k(me),k(ee),k(ne),k(B))};static \u0275cmp=S({type:i,selectors:[["app-sign-folder"]],decls:26,vars:9,consts:[[1,"sign-folder-container"],[1,"language-selector-container"],[1,"page-header"],["appTranslate","sign_multiple_documents"],["appTranslate","upload_docs_subtitle"],["class","alert alert-danger",4,"ngIf"],[1,"sign-folder-content"],[1,"documents-section"],["appTranslate","upload_documents"],[4,"ngIf"],["class","documents-list",4,"ngIf"],[1,"signature-section"],[3,"signatureSelected"],[1,"signature-position-selector"],["appTranslate","signature_position"],[1,"position-grid"],["class","position-button",3,"active","appTranslate","click",4,"ngFor","ngForOf"],["class","page-selection-selector",4,"ngIf"],["class","processing-progress",4,"ngIf"],[1,"action-buttons"],[1,"btn","btn-secondary",3,"click"],["appTranslate","reset"],[1,"btn","btn-primary",3,"click","disabled"],["appTranslate","processing",4,"ngIf"],["appTranslate","sign_documents_button",4,"ngIf"],[1,"alert","alert-danger"],[3,"filesSelected","acceptedTypes","multiple","allowFolders","label","dropzoneText"],[1,"documents-list"],[1,"documents-list-header"],["appTranslate","selected_documents"],["appTranslate","clear_all",1,"btn","btn-sm","btn-secondary",3,"click"],[1,"documents-grid"],["class","document-card",4,"ngFor","ngForOf"],[1,"add-more-container"],[1,"add-more-card",3,"click"],[1,"add-icon"],["appTranslate","add_more_files"],["appTranslate","add_folder"],[1,"document-card"],[1,"document-card-header"],[1,"document-type-badge"],[1,"remove-document",3,"click"],[1,"document-preview"],["class","document-image",4,"ngIf"],["class","document-pdf",4,"ngIf"],[1,"document-name",3,"title"],[1,"document-image"],[3,"src","alt"],[1,"document-pdf"],["xmlns","http://www.w3.org/2000/svg","width","40","height","48","viewBox","0 0 384 512"],["fill","#e74c3c","d","M369.9 97.9L286 14C277 5 264.8-.1 252.1-.1H48C21.5 0 0 21.5 0 48v416c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V131.9c0-12.7-5.1-25-14.1-34zM332.1 128H256V51.9l76.1 76.1zM48 464V48h160v104c0 13.3 10.7 24 24 24h104v288H48z"],[1,"position-button",3,"click","appTranslate"],[1,"page-selection-selector"],["appTranslate","page_selection"],[1,"radio-group"],["class","radio-item",4,"ngFor","ngForOf"],["class","custom-range-container",4,"ngIf"],[1,"radio-item"],["type","radio","name","pageSelectionMode",3,"ngModelChange","change","id","value","ngModel"],[3,"for","appTranslate"],[1,"custom-range-container"],[1,"form-row"],[1,"form-group"],["for","pageStart","appTranslate","start_page"],["type","number","id","pageStart","min","1",1,"form-control",3,"ngModelChange","change","ngModel","max"],["for","pageEnd","appTranslate","end_page"],["type","number","id","pageEnd",1,"form-control",3,"ngModelChange","change","ngModel","min","max"],[1,"processing-progress"],[1,"progress"],[1,"progress-bar"],["appTranslate","processing_documents",1,"processing-text"],["appTranslate","processing"],["appTranslate","sign_documents_button"]],template:function(e,n){e&1&&(r(0,"div",0)(1,"div",1),p(2,"app-language-switcher"),a(),r(3,"div",2),p(4,"h2",3)(5,"p",4),a(),f(6,Fe,2,1,"div",5),r(7,"div",6)(8,"div",7),p(9,"h3",8),f(10,ke,4,9,"div",9)(11,Ue,17,2,"div",10),a(),r(12,"div",11)(13,"app-signature-upload",12),g("signatureSelected",function(s){return n.onSignatureSelected(s)}),a(),r(14,"div",13),p(15,"h4",14),r(16,"div",15),f(17,Le,1,5,"button",16),a()(),f(18,Re,5,2,"div",17),a()(),f(19,Ae,5,3,"div",18),r(20,"div",19)(21,"button",20),g("click",function(){return n.reset()}),p(22,"span",21),a(),r(23,"button",22),g("click",function(){return n.signDocuments()}),f(24,Ne,1,0,"span",23)(25,Be,1,0,"span",24),a()()()),e&2&&(l(6),d("ngIf",n.error),l(4),d("ngIf",n.documents.length===0),l(),d("ngIf",n.documents.length>0),l(6),d("ngForOf",n.signaturePositionOptions),l(),d("ngIf",n.hasMultiPageDocuments()),l(),d("ngIf",n.isProcessing),l(4),d("disabled",n.documents.length===0||!n.signature||n.isProcessing),l(),d("ngIf",n.isProcessing),l(),d("ngIf",!n.isProcessing))},dependencies:[y,A,w,N,de,ie,ae,se,oe,ce,le,re,T,W,te,O],styles:['.sign-folder-container[_ngcontent-%COMP%]{max-width:900px;margin:0 auto}.page-header[_ngcontent-%COMP%]{margin-bottom:2rem;text-align:center}.page-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-bottom:.5rem;color:#2c3e50}.page-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#6c757d}.sign-folder-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2rem}.documents-section[_ngcontent-%COMP%], .signature-section[_ngcontent-%COMP%]{background-color:#fff;border-radius:.5rem;padding:1.5rem;box-shadow:0 2px 5px #0000001a}.documents-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .signature-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-bottom:1rem;color:#2c3e50;font-size:1.25rem}.documents-list[_ngcontent-%COMP%]{margin-top:1rem}.documents-list-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.documents-list-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0;font-size:1.1rem;color:#495057}.documents-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(150px,1fr));gap:1rem;margin-top:1rem}.document-card[_ngcontent-%COMP%]{border:1px solid #dee2e6;border-radius:.25rem;overflow:hidden;background-color:#f8f9fa;display:flex;flex-direction:column;position:relative;height:180px}.document-card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:.5rem;background-color:#f0f0f0}.document-type-badge[_ngcontent-%COMP%]{font-size:.75rem;padding:.25rem .5rem;border-radius:.25rem;background-color:#6c757d;color:#fff;text-transform:uppercase}.document-type-badge.pdf[_ngcontent-%COMP%]{background-color:#e74c3c}.document-type-badge.image[_ngcontent-%COMP%]{background-color:#3498db}.remove-document[_ngcontent-%COMP%]{background:none;border:none;color:#6c757d;font-size:1.25rem;cursor:pointer;line-height:1;padding:0}.remove-document[_ngcontent-%COMP%]:hover{color:#dc3545}.document-preview[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center;justify-content:center;padding:.5rem;background-color:#fff}.document-image[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;align-items:center;justify-content:center;overflow:hidden}.sign-folder-container[_ngcontent-%COMP%]{padding:20px;max-width:1200px;margin:0 auto}.page-header[_ngcontent-%COMP%]{margin-bottom:30px;text-align:center}.page-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-bottom:10px;color:#333}.sign-folder-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:30px}@media (min-width: 992px){.sign-folder-content[_ngcontent-%COMP%]{flex-direction:row}.documents-section[_ngcontent-%COMP%]{flex:3}.signature-section[_ngcontent-%COMP%]{flex:2}}.documents-section[_ngcontent-%COMP%], .signature-section[_ngcontent-%COMP%]{background-color:#f9f9f9;padding:20px;border-radius:8px;box-shadow:0 2px 4px #0000001a}.documents-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .signature-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-bottom:20px;padding-bottom:10px;border-bottom:1px solid #eee}.documents-list-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:15px}.documents-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(150px,1fr));gap:15px}.document-card[_ngcontent-%COMP%]{background-color:#fff;border-radius:6px;overflow:hidden;box-shadow:0 1px 3px #0000001a;position:relative}.document-card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:8px;background-color:#f5f5f5}.document-type-badge[_ngcontent-%COMP%]{font-size:12px;padding:2px 6px;border-radius:3px;background-color:#e9ecef}.document-type-badge.pdf[_ngcontent-%COMP%]{background-color:#e74c3c;color:#fff}.document-type-badge.image[_ngcontent-%COMP%]{background-color:#3498db;color:#fff}.remove-document[_ngcontent-%COMP%]{background:none;border:none;color:#6c757d;font-size:16px;cursor:pointer}.document-preview[_ngcontent-%COMP%]{height:120px;display:flex;align-items:center;justify-content:center;background-color:#f8f9fa;padding:10px}.document-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%;max-height:100px;object-fit:contain}.document-name[_ngcontent-%COMP%]{padding:8px;font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-align:center;border-top:1px solid #eee}.language-selector-container[_ngcontent-%COMP%]{margin-bottom:20px;padding:10px;background-color:#f8f9fa;border-radius:8px;box-shadow:0 2px 4px #0000001a}[dir="rtl"][_nghost-%COMP%]   .language-selector-container[_ngcontent-%COMP%], [dir="rtl"]   [_nghost-%COMP%]   .language-selector-container[_ngcontent-%COMP%]{justify-content:flex-start}.add-more-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:15px}.add-more-card[_ngcontent-%COMP%]{width:162px;height:140px;border:2px dashed #ccc;border-radius:6px;display:flex;flex-direction:column;align-items:center;justify-content:center;cursor:pointer;transition:all .2s;text-align:center;font-weight:500}.add-more-card[_ngcontent-%COMP%]:hover{border-color:#007bff;background-color:#007bff0d}.add-icon[_ngcontent-%COMP%]{font-size:24px;margin-bottom:8px;color:#6c757d}.processing-progress[_ngcontent-%COMP%]{margin:20px 0}.progress[_ngcontent-%COMP%]{height:20px;border-radius:4px;background-color:#e9ecef;overflow:hidden;margin-bottom:10px}.progress-bar[_ngcontent-%COMP%]{height:100%;background-color:#007bff;color:#fff;text-align:center;transition:width .2s ease;display:flex;align-items:center;justify-content:center;font-size:12px}.processing-text[_ngcontent-%COMP%]{text-align:center;color:#6c757d}.signature-position-selector[_ngcontent-%COMP%]{margin-top:20px;padding-top:20px;border-top:1px solid #eee}.signature-position-selector[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin-bottom:15px;font-size:1.1rem;color:#495057}.position-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);gap:8px}.position-button[_ngcontent-%COMP%]{padding:10px 5px;background-color:#f8f9fa;border:1px solid #dee2e6;border-radius:4px;cursor:pointer;transition:all .2s;font-size:.9rem;text-align:center}.position-button[_ngcontent-%COMP%]:hover{background-color:#e9ecef}.position-button.active[_ngcontent-%COMP%]{background-color:#007bff;color:#fff;border-color:#007bff}.page-selection-selector[_ngcontent-%COMP%]{margin-top:20px;padding-top:20px;border-top:1px solid #eee}.page-selection-selector[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin-bottom:15px;font-size:1.1rem;color:#495057}.radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px;margin-bottom:15px}.radio-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.radio-item[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{margin:0}.radio-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin:0;cursor:pointer}.custom-range-container[_ngcontent-%COMP%]{margin-top:15px;padding:15px;border:1px solid #e9ecef;border-radius:4px;background-color:#f8f9fa}.form-row[_ngcontent-%COMP%]{display:flex;gap:15px}.form-group[_ngcontent-%COMP%]{flex:1}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:5px;font-size:.9rem;color:#495057}.form-control[_ngcontent-%COMP%]{width:100%;padding:8px;font-size:1rem;border:1px solid #ced4da;border-radius:4px}.action-buttons[_ngcontent-%COMP%]{margin-top:30px;display:flex;justify-content:flex-end;gap:10px}.document-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%;max-height:100%;object-fit:contain}.document-pdf[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.document-name[_ngcontent-%COMP%]{padding:.5rem;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-size:.875rem;text-align:center;background-color:#f8f9fa;border-top:1px solid #dee2e6}.add-more-card[_ngcontent-%COMP%]{width:162px;border:2px dashed #ced4da;border-radius:.25rem;height:180px;display:flex;flex-direction:column;align-items:center;justify-content:center;cursor:pointer;color:#6c757d;transition:all .3s ease}.add-more-card[_ngcontent-%COMP%]:hover{border-color:#3498db;color:#3498db}.add-icon[_ngcontent-%COMP%]{font-size:2rem;margin-bottom:.5rem}.processing-progress[_ngcontent-%COMP%]{margin-top:2rem}.progress[_ngcontent-%COMP%]{height:1.5rem;background-color:#e9ecef;border-radius:.25rem;margin-bottom:.5rem;overflow:hidden}.progress-bar[_ngcontent-%COMP%]{height:100%;background-color:#3498db;color:#fff;text-align:center;line-height:1.5rem;transition:width .2s ease}.processing-text[_ngcontent-%COMP%]{text-align:center;color:#6c757d;font-style:italic}.action-buttons[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-top:2rem}@media (min-width: 768px){.sign-folder-content[_ngcontent-%COMP%]{flex-direction:row}.documents-section[_ngcontent-%COMP%]{flex:2}.signature-section[_ngcontent-%COMP%]{flex:1}}']})};export{he as SignFolderComponent};
