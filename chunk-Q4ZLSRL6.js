import{h as A,j as G,k as q}from"./chunk-PWVN3RVT.js";import{a as $,b as F,c as H,d as N}from"./chunk-XY6EKUD7.js";import{$ as l,C as S,G as M,H as O,I as u,J as i,K as a,L as _,M as w,N as x,O as p,Q as T,R as c,S as g,T as v,U as k,_ as s,ga as R,ha as V,ia as j,ja as z,k as b,l as h,m as y,ma as U,n as D,u as P,v as n,x as C,y as B}from"./chunk-TZAG237N.js";import{e as L}from"./chunk-FDERIQAA.js";function J(r,o){if(r&1&&(i(0,"p"),c(1),s(2,"async"),a()),r&2){let e=p();n(),g(e.translations[l(2,1,e.languageService.selectedLanguage)||"en"].pdf_signed)}}function K(r,o){if(r&1&&(i(0,"p"),c(1),s(2,"async"),a()),r&2){let e=p();n(),g(e.translations[l(2,1,e.languageService.selectedLanguage)||"en"].image_signed)}}function Q(r,o){if(r&1&&(i(0,"div",30),_(1,"img",31),a()),r&2){let e=p().$implicit;n(),u("src",e.preview,P)("alt",e.name)}}function X(r,o){r&1&&(i(0,"div",32),y(),i(1,"svg",33),_(2,"path",34),a()())}function Y(r,o){if(r&1){let e=w();i(0,"div",18)(1,"div",19)(2,"span",20),c(3),a(),i(4,"span",21),c(5),s(6,"async"),a()(),i(7,"div",22),S(8,Q,2,2,"div",23)(9,X,3,0,"div",24),a(),i(10,"div",25),c(11),a(),i(12,"div",26)(13,"span",27),c(14),s(15,"async"),s(16,"async"),s(17,"async"),a()(),i(18,"div",28)(19,"button",29),x("click",function(){let m=b(e).$implicit,d=p();return h(d.downloadDocument(m))}),c(20),s(21,"async"),a()()()}if(r&2){let e=o.$implicit,t=p();n(2),T("pdf",e.type==="pdf")("image",e.type==="image"),n(),v(" ",e.type," "),n(2),g(t.translations[l(6,13,t.languageService.selectedLanguage)||"en"].signed),n(3),u("ngIf",e.type==="image"),n(),u("ngIf",e.type==="pdf"),n(),u("title",e.name),n(),v(" ",e.name," "),n(3),k(" ",t.translations[l(15,15,t.languageService.selectedLanguage)||"en"].signature,": ",e.signaturePosition===t.SignaturePosition.TOP_CENTER?t.translations[l(16,17,t.languageService.selectedLanguage)||"en"].top_center:t.translations[l(17,19,t.languageService.selectedLanguage)||"en"].bottom_center," "),n(6),v(" ",t.translations[l(21,21,t.languageService.selectedLanguage)||"en"].download," ")}}function Z(r,o){if(r&1&&(i(0,"div",35)(1,"h4"),c(2),s(3,"async"),a(),i(4,"div",36),_(5,"img",37),a()()),r&2){let e=p();n(2),g(e.translations[l(3,2,e.languageService.selectedLanguage)||"en"].signature_used),n(3),u("src",e.signature.preview,P)}}function ee(r,o){if(r&1){let e=w();i(0,"div",38)(1,"h4"),c(2),s(3,"async"),a(),i(4,"p"),c(5),s(6,"async"),a(),i(7,"div",39)(8,"label",40),c(9),s(10,"async"),a(),i(11,"p",41),c(12),s(13,"async"),a(),i(14,"p",42),c(15),s(16,"async"),a(),i(17,"button",43),x("click",function(){b(e);let m=p();return h(m.saveToLocation())}),c(18),s(19,"async"),a()()()}if(r&2){let e=p();n(2),g(e.translations[l(3,6,e.languageService.selectedLanguage)||"en"].save_document),n(3),g(e.translations[l(6,8,e.languageService.selectedLanguage)||"en"].specify_save),n(4),g(e.translations[l(10,10,e.languageService.selectedLanguage)||"en"].save_location),n(3),g(e.translations[l(13,12,e.languageService.selectedLanguage)||"en"].click_save),n(3),g(e.translations[l(16,14,e.languageService.selectedLanguage)||"en"].browser_compat),n(3),v(" ",e.translations[l(19,16,e.languageService.selectedLanguage)||"en"].save_to_location," ")}}function te(r,o){if(r&1){let e=w();i(0,"div",44)(1,"h4"),c(2),s(3,"async"),a(),i(4,"button",43),x("click",function(){b(e);let m=p();return h(m.downloadAllDocuments())}),c(5),s(6,"async"),a(),i(7,"div",45)(8,"label",40),c(9),s(10,"async"),a(),i(11,"p",41),c(12),s(13,"async"),a(),i(14,"p",42),c(15),s(16,"async"),a(),i(17,"button",43),x("click",function(){b(e);let m=p();return h(m.saveToLocation())}),c(18),s(19,"async"),a()()()}if(r&2){let e=p();n(2),g(e.translations[l(3,6,e.languageService.selectedLanguage)||"en"].bulk_actions),n(3),v(" ",e.translations[l(6,8,e.languageService.selectedLanguage)||"en"].download_all," "),n(4),g(e.translations[l(10,10,e.languageService.selectedLanguage)||"en"].save_location),n(3),g(e.translations[l(13,12,e.languageService.selectedLanguage)||"en"].click_below),n(3),g(e.translations[l(16,14,e.languageService.selectedLanguage)||"en"].browser_compat),n(3),v(" ",e.translations[l(19,16,e.languageService.selectedLanguage)||"en"].save_all," ")}}var W=class r{constructor(o,e,t,m){this.documentService=o;this.router=e;this.translationService=t;this.languageService=m}documents=[];signature=null;savePath="";isSingleDocument=!1;hasPdfDocuments=!1;hasImageDocuments=!1;SignaturePosition=G;translations=$;ngOnInit(){this.documentService.getProcessedDocuments().subscribe(o=>{this.documents=o,this.isSingleDocument=o.length===1,this.hasPdfDocuments=o.some(e=>e.type==="pdf"),this.hasImageDocuments=o.some(e=>e.type==="image")}),this.documentService.getSignature().subscribe(o=>{this.signature=o}),this.documents.length===0&&this.router.navigate(["/"])}downloadDocument(o){if(o.signedUrl){let e=o.signedUrl,t=window.document.createElement("a");t.href=e,t.download=`signed_${o.name}`,window.document.body.appendChild(t),t.click(),window.document.body.removeChild(t)}}downloadAllDocuments(){this.documents.forEach(o=>{this.downloadDocument(o)})}startNewProcess(){this.documentService.clearDocuments(),this.documentService.setProcessedDocuments([]),this.router.navigate(["/"])}saveToLocation(){return L(this,null,function*(){try{let o=this.languageService.getCurrentLanguage();if(!("showDirectoryPicker"in window)){alert(this.translations[o].browser_not_supported);return}if(!window.isSecureContext){alert(this.translations[o].secure_context_required);return}let e=yield window.showDirectoryPicker(),t=[],m=[];for(let d of this.documents){if(!d.signedBlob&&!d.signedUrl){console.error(`No blob or URL found for document: ${d.name}`),m.push(d.name);continue}try{let f=d.signedBlob;if(!f&&d.signedUrl)try{f=yield(yield fetch(d.signedUrl)).blob(),console.log(`Created blob from URL for document: ${d.name}`,f)}catch(E){console.error(`Error creating blob from URL for document: ${d.name}:`,E),m.push(d.name);continue}let I=yield(yield e.getFileHandle(`signed_${d.name}`,{create:!0})).createWritable();yield I.write(f),yield I.close(),t.push(d.name),console.log(`Successfully saved file: ${d.name}`)}catch(f){console.error(`Error saving file ${d.name}:`,f),m.push(d.name)}}t.length>0?m.length>0?alert(this.translations[o].documents_saved_failed+t.length.toString()+m.join(", ")):alert(this.translations[o].documents_saved+t.length.toString()):alert(this.translations[o].no_documents_saved)}catch(o){if(console.error("Error saving documents:",o),o.name!=="AbortError"){let e=this.languageService.getCurrentLanguage();alert(this.translations[e].error_signing)}}})}static \u0275fac=function(e){return new(e||r)(C(q),C(U),C(N),C(F))};static \u0275cmp=B({type:r,selectors:[["app-result"]],decls:32,vars:19,consts:[[1,"result-container"],[1,"language-selector-container"],[1,"page-header"],[1,"success-icon"],["xmlns","http://www.w3.org/2000/svg","width","48","height","48","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["d","M22 11.08V12a10 10 0 1 1-5.93-9.14"],["points","22 4 12 14.01 9 11.01"],[1,"additional-info"],[1,"result-content"],[1,"documents-preview"],[1,"documents-grid"],["class","document-card",4,"ngFor","ngForOf"],[1,"save-options"],["class","signature-preview",4,"ngIf"],["class","save-location",4,"ngIf"],["class","bulk-actions",4,"ngIf"],[1,"action-buttons"],[1,"btn","btn-primary",3,"click"],[1,"document-card"],[1,"document-card-header"],[1,"document-type-badge"],[1,"signed-badge"],[1,"document-preview"],["class","document-image",4,"ngIf"],["class","document-pdf",4,"ngIf"],[1,"document-name",3,"title"],[1,"document-details"],[1,"signature-position"],[1,"document-actions"],[1,"btn","btn-sm","btn-primary",3,"click"],[1,"document-image"],[3,"src","alt"],[1,"document-pdf"],["xmlns","http://www.w3.org/2000/svg","width","40","height","48","viewBox","0 0 384 512"],["fill","#e74c3c","d","M369.9 97.9L286 14C277 5 264.8-.1 252.1-.1H48C21.5 0 0 21.5 0 48v416c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V131.9c0-12.7-5.1-25-14.1-34zM332.1 128H256V51.9l76.1 76.1zM48 464V48h160v104c0 13.3 10.7 24 24 24h104v288H48z"],[1,"signature-preview"],[1,"signature-image"],["alt","Signature",3,"src"],[1,"save-location"],[1,"form-group"],["for","save-path"],[1,"small","text-muted"],[1,"small","text-warning"],[1,"btn","btn-success","btn-block",3,"click"],[1,"bulk-actions"],[1,"form-group","mt-3"]],template:function(e,t){e&1&&(i(0,"div",0)(1,"div",1),_(2,"app-language-switcher"),a(),i(3,"div",2)(4,"div",3),y(),i(5,"svg",4),_(6,"path",5)(7,"polyline",6),a()(),D(),i(8,"h2"),c(9),s(10,"async"),a(),i(11,"p"),c(12),s(13,"async"),a(),i(14,"div",7),M(15,J,3,3,"p"),M(16,K,3,3,"p"),a()(),i(17,"div",8)(18,"div",9)(19,"h3"),c(20),s(21,"async"),a(),i(22,"div",10),S(23,Y,22,23,"div",11),a()(),i(24,"div",12),S(25,Z,6,4,"div",13)(26,ee,20,18,"div",14)(27,te,20,18,"div",15),a()(),i(28,"div",16)(29,"button",17),x("click",function(){return t.startNewProcess()}),c(30),s(31,"async"),a()()()),e&2&&(n(9),g(t.translations[l(10,11,t.languageService.selectedLanguage)||"en"].documents_signed),n(3),g(t.translations[l(13,13,t.languageService.selectedLanguage)||"en"].documents_signed_subtitle),n(3),O(t.hasPdfDocuments?15:-1),n(),O(t.hasImageDocuments?16:-1),n(4),k("",t.translations[l(21,15,t.languageService.selectedLanguage)||"en"].signed_documents," (",t.documents.length,")"),n(3),u("ngForOf",t.documents),n(2),u("ngIf",t.signature),n(),u("ngIf",t.isSingleDocument),n(),u("ngIf",!t.isSingleDocument),n(3),v(" ",t.translations[l(31,17,t.languageService.selectedLanguage)||"en"].sign_new," "))},dependencies:[z,R,V,j,A,H],styles:['.result-container[_ngcontent-%COMP%]{max-width:900px;margin:0 auto}.language-selector-container[_ngcontent-%COMP%]{margin-bottom:20px;padding:10px;background-color:#f8f9fa;border-radius:8px;box-shadow:0 2px 4px #0000001a}[dir="rtl"][_nghost-%COMP%]   .language-selector-container[_ngcontent-%COMP%], [dir="rtl"]   [_nghost-%COMP%]   .language-selector-container[_ngcontent-%COMP%]{justify-content:flex-start}.page-header[_ngcontent-%COMP%]{margin-bottom:2rem;text-align:center;display:flex;flex-direction:column;align-items:center}.success-icon[_ngcontent-%COMP%]{margin-bottom:1rem;color:#2ecc71;display:flex;align-items:center;justify-content:center;width:80px;height:80px;background-color:#2ecc711a;border-radius:50%}.page-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-bottom:.5rem;color:#2c3e50}.page-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#6c757d}.small[_ngcontent-%COMP%]{text-align:center;display:block;margin:.5rem 0}.result-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2rem}.documents-preview[_ngcontent-%COMP%], .save-options[_ngcontent-%COMP%]{background-color:#fff;border-radius:.5rem;padding:1.5rem;box-shadow:0 2px 5px #0000001a}.documents-preview[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .save-options[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-bottom:1rem;color:#2c3e50;font-size:1.25rem}.documents-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:1rem;margin-top:1rem}.document-card[_ngcontent-%COMP%]{border:1px solid #dee2e6;border-radius:.25rem;overflow:hidden;background-color:#f8f9fa;display:flex;flex-direction:column;position:relative}.document-card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:.5rem;background-color:#f0f0f0}.document-type-badge[_ngcontent-%COMP%]{font-size:.75rem;padding:.25rem .5rem;border-radius:.25rem;background-color:#6c757d;color:#fff;text-transform:uppercase}.document-type-badge.pdf[_ngcontent-%COMP%]{background-color:#e74c3c}.document-type-badge.image[_ngcontent-%COMP%]{background-color:#3498db}.signed-badge[_ngcontent-%COMP%]{font-size:.75rem;padding:.25rem .5rem;border-radius:.25rem;background-color:#2ecc71;color:#fff;text-transform:uppercase}.document-preview[_ngcontent-%COMP%]{height:150px;display:flex;align-items:center;justify-content:center;padding:.5rem;background-color:#fff}.document-image[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;align-items:center;justify-content:center;overflow:hidden}.document-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%;max-height:100%;object-fit:contain}.additional-info[_ngcontent-%COMP%]{margin-top:20px;padding:15px;background-color:#f8f9fa;border-radius:8px;border-left:4px solid #28a745}.additional-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.9rem;margin-bottom:5px;color:#555}.document-pdf[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.document-name[_ngcontent-%COMP%]{padding:.5rem;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-size:.875rem;text-align:center;background-color:#f8f9fa;border-top:1px solid #dee2e6}.document-actions[_ngcontent-%COMP%]{padding:.5rem;text-align:center;border-top:1px solid #dee2e6}.save-options[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem}.signature-preview[_ngcontent-%COMP%]{text-align:center}.signature-preview[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin-bottom:1rem;color:#495057}.signature-image[_ngcontent-%COMP%]{padding:1rem;background-color:#f8f9fa;border:1px solid #dee2e6;border-radius:.25rem;display:flex;justify-content:center}.signature-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%;max-height:100px;object-fit:contain}.save-location[_ngcontent-%COMP%], .bulk-actions[_ngcontent-%COMP%]{padding-top:1.5rem;border-top:1px solid #eee}.save-location[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%], .bulk-actions[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin-bottom:.5rem;color:#495057}.save-location[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .bulk-actions[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:1rem;color:#6c757d;font-size:.9rem}.btn-block[_ngcontent-%COMP%]{display:block;width:100%}.mt-3[_ngcontent-%COMP%]{margin-top:1rem}.action-buttons[_ngcontent-%COMP%]{margin-top:2rem;text-align:center}@media (min-width: 768px){.result-content[_ngcontent-%COMP%]{flex-direction:row}.documents-preview[_ngcontent-%COMP%]{flex:2}.save-options[_ngcontent-%COMP%]{flex:1}}']})};export{W as ResultComponent};
